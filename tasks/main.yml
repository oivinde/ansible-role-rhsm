---
# tasks file for ansible-role-rhel-cloud-postconf

# Variable setup.
- name: Include OS-Major version variables.
  include_vars: "{{ ansible_distribution_major_version }}.yml"

- name: Attach subscription
  redhat_subscription:
    state: present
    username: "{{ rhel_cloud_postconf_rhsm_username }}"
    password: "{{ rhel_cloud_postconf_rhsm_password }}"
    pool_ids: "{{ rhel_cloud_postconf_rhsm_pool_id }}"

- name: Disable all RHSM repositories
  rhsm_repository:
    name: '*'
    state: disabled

- name: Enable a RHSM repository
  rhsm_repository:
    name: "{{ item }}"
  with_items: "{{ rhel_cloud_postconf_rhsm_repos }}"
